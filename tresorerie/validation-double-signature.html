<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validation Double Signature - Trésorerie | MultiFlex GESCOM</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">

    <!-- Styles -->
    <link rel="stylesheet" href="./styles/tresorerie-common.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        * { font-family: "Poppins", sans-serif; }
        html, body { margin: 0; padding: 0; height: 100%; }

        .validation-card {
            background: white;
            border-radius: 8px;
            border: 1px solid #E5E7EB;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.2s;
        }
        .validation-card:hover {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .validation-card.urgent {
            border-left: 4px solid #EF4444;
        }
        .validation-card.normal {
            border-left: 4px solid #F59E0B;
        }

        .workflow-step {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #F9FAFB;
            border-radius: 8px;
            margin-bottom: 8px;
        }
        .workflow-step.completed {
            background: #ECFDF5;
        }
        .workflow-step.pending {
            background: #FEF3C7;
        }
        .workflow-step.current {
            background: #DBEAFE;
            border: 2px solid #3B82F6;
        }
    </style>
</head>
<body class="h-full text-gray-800">
    <div class="h-screen flex flex-col">
        <!-- Header -->
        <header class="flex h-16 bg-white shadow-sm z-50">
            <div class="w-60 bg-[#263c89] flex items-center justify-center">
                <img src="https://microfinance-ccm.com/iola/logo-blanc.png" alt="Multiflex" class="h-10">
            </div>
            <div class="flex-1 flex items-center justify-between px-6">
                <h1 class="text-xl font-bold text-[#1A1A1A]">Validation Double Signature</h1>
                <div class="flex items-center gap-4">
                    <div class="relative">
                        <i class="fa-solid fa-bell text-[#666666] text-lg cursor-pointer"></i>
                        <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold">2</span>
                    </div>
                    <div class="flex items-center cursor-pointer">
                        <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-8 h-8 rounded-full mr-3">
                        <span class="text-[14px] text-[#1A1A1A] mr-2">Jean KAMGA</span>
                        <i class="fa-solid fa-chevron-down text-[#666666] text-sm"></i>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="flex-1 flex overflow-hidden">
            <!-- Sidebar -->
            <aside class="w-60 bg-[#263c89] text-white overflow-y-auto">
                <nav class="py-4">
                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mb-2">Module Trésorerie</div>
                    <a href="./dashboard.html" class="sidebar-link" data-page="dashboard"><i class="fa-solid fa-chart-pie mr-3"></i><span>Dashboard</span></a>
                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mt-4 mb-2">Journaux</div>
                    <a href="./journals-list.html" class="sidebar-link" data-page="journals-list"><i class="fa-solid fa-book mr-3"></i><span>Liste Journaux</span></a>
                    <a href="./journal-create.html" class="sidebar-link" data-page="journal-create"><i class="fa-solid fa-plus-circle mr-3"></i><span>Nouveau Journal</span></a>
                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mt-4 mb-2">Encaissements</div>
                    <a href="./encaissement-create.html" class="sidebar-link" data-page="encaissement-create"><i class="fa-solid fa-arrow-down mr-3"></i><span>Nouvel Encaissement</span></a>
                    <a href="./encaissement-imputation.html" class="sidebar-link" data-page="encaissement-imputation"><i class="fa-solid fa-list-check mr-3"></i><span>Imputation</span></a>
                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mt-4 mb-2">Décaissements</div>
                    <a href="./decaissement-create.html" class="sidebar-link" data-page="decaissement-create"><i class="fa-solid fa-arrow-up mr-3"></i><span>Nouveau Décaissement</span></a>
                    <a href="./validation-double-signature.html" class="sidebar-link" data-page="validation-double-signature"><i class="fa-solid fa-signature mr-3"></i><span>Double Signature</span><span class="ml-2 bg-[#F26F21] text-white text-xs px-2 py-0.5 rounded-full">2</span></a>
                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mt-4 mb-2">Acomptes</div>
                    <a href="./acompte-transport.html" class="sidebar-link" data-page="acompte-transport"><i class="fa-solid fa-truck-ramp-box mr-3"></i><span>Acompte Transport</span></a>
                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mt-6 mb-2">Système</div>
                    <a href="../index.html" class="sidebar-link" data-page="home"><i class="fa-solid fa-home mr-3"></i><span>Accueil</span></a>
                </nav>
            </aside>

            <!-- Main Content Area -->
            <div class="flex-1 overflow-auto bg-[#F8F9FA]">
                <div class="tresorerie-container" style="max-width: none; padding: 24px;">

                    <!-- Page Header -->
                    <div class="page-header">
                        <div class="page-header-top">
                            <div>
                                <h1 class="page-title">
                                    <i class="fa-solid fa-signature"></i>
                                    Validation Double Signature
                                </h1>
                                <p class="page-description">
                                    Transactions en attente de votre validation
                                </p>
                            </div>
                        </div>

                        <!-- Stats -->
                        <div class="stats-grid" style="grid-template-columns: repeat(4, 1fr);">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div><div class="stat-label">En Attente</div></div>
                                    <div class="stat-icon warning"><i class="fa-solid fa-clock"></i></div>
                                </div>
                                <div class="stat-value" style="color: #F59E0B;">2</div>
                                <div class="stat-change neutral">À valider</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div><div class="stat-label">Montant Total</div></div>
                                    <div class="stat-icon danger"><i class="fa-solid fa-coins"></i></div>
                                </div>
                                <div class="stat-value">2.5M XAF</div>
                                <div class="stat-change neutral">En attente</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div><div class="stat-label">Validées ce Mois</div></div>
                                    <div class="stat-icon success"><i class="fa-solid fa-check-circle"></i></div>
                                </div>
                                <div class="stat-value" style="color: #10B981;">15</div>
                                <div class="stat-change positive">+3 vs mois dernier</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div><div class="stat-label">Rejetées</div></div>
                                    <div class="stat-icon danger"><i class="fa-solid fa-times-circle"></i></div>
                                </div>
                                <div class="stat-value">1</div>
                                <div class="stat-change negative">Ce mois</div>
                            </div>
                        </div>
                    </div>

                    <!-- Filters -->
                    <div class="filters-bar">
                        <div class="filters-row">
                            <div class="filter-group" style="flex: 2;">
                                <input type="text" class="search-input" placeholder="Rechercher par référence, fournisseur..." id="searchInput">
                            </div>
                            <div class="filter-group">
                                <select class="filter-select" id="typeFilter">
                                    <option value="">Tous les types</option>
                                    <option value="decaissement">Décaissements</option>
                                    <option value="virement">Virements</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <select class="filter-select" id="urgencyFilter">
                                    <option value="">Toutes urgences</option>
                                    <option value="urgent">Urgent</option>
                                    <option value="normal">Normal</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Pending Validations -->
                    <div class="grid grid-cols-1 gap-4">
                        <!-- Card 1 - Urgent -->
                        <div class="validation-card urgent">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <div class="flex items-center gap-3">
                                        <span class="font-mono font-semibold text-[#263c89]">DEC-2024-00456</span>
                                        <span class="badge badge-rejete">Urgent</span>
                                    </div>
                                    <div class="text-muted text-sm mt-1">Créé le 15/01/2024 à 14:30 par Marie NJOYA</div>
                                </div>
                                <div class="text-right">
                                    <div class="text-2xl font-bold text-danger">1 500 000 XAF</div>
                                    <div class="text-sm text-muted">Décaissement Fournisseur</div>
                                </div>
                            </div>

                            <div class="info-grid" style="grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 16px;">
                                <div class="info-item">
                                    <span class="info-label">Bénéficiaire</span>
                                    <span class="info-value">AFRILAND SUPPLIES</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Facture</span>
                                    <span class="info-value font-mono">FFOU-2024-00123</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Mode</span>
                                    <span class="info-value">Virement Bancaire</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Journal</span>
                                    <span class="info-value">Compte Afriland</span>
                                </div>
                            </div>

                            <!-- Workflow Status -->
                            <div class="mb-4">
                                <label class="form-label mb-2">Workflow de Validation</label>
                                <div class="workflow-step completed">
                                    <i class="fa-solid fa-check-circle text-success"></i>
                                    <div>
                                        <div class="font-semibold">Demande créée</div>
                                        <div class="text-sm text-muted">Marie NJOYA - 15/01/2024 14:30</div>
                                    </div>
                                </div>
                                <div class="workflow-step current">
                                    <i class="fa-solid fa-clock text-info"></i>
                                    <div>
                                        <div class="font-semibold">En attente de validation</div>
                                        <div class="text-sm text-muted">Jean KAMGA (Trésorier Principal)</div>
                                    </div>
                                </div>
                                <div class="workflow-step pending">
                                    <i class="fa-solid fa-hourglass-half text-warning"></i>
                                    <div>
                                        <div class="font-semibold">Exécution</div>
                                        <div class="text-sm text-muted">En attente de validation</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Actions -->
                            <div class="flex justify-between items-center pt-4 border-t">
                                <div class="flex gap-2">
                                    <button class="btn btn-secondary btn-sm" onclick="viewDetails('DEC-2024-00456')">
                                        <i class="fa-solid fa-eye"></i>
                                        Voir Détails
                                    </button>
                                    <button class="btn btn-secondary btn-sm" onclick="viewAttachments('DEC-2024-00456')">
                                        <i class="fa-solid fa-paperclip"></i>
                                        Pièces Jointes
                                    </button>
                                </div>
                                <div class="flex gap-2">
                                    <button class="btn btn-secondary btn-sm" onclick="requestInfo('DEC-2024-00456')">
                                        <i class="fa-solid fa-question-circle"></i>
                                        Demander Infos
                                    </button>
                                    <button class="btn btn-danger btn-sm" onclick="rejectTransaction('DEC-2024-00456')">
                                        <i class="fa-solid fa-times"></i>
                                        Rejeter
                                    </button>
                                    <button class="btn btn-success" onclick="approveTransaction('DEC-2024-00456')">
                                        <i class="fa-solid fa-check"></i>
                                        Approuver
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Card 2 - Normal -->
                        <div class="validation-card normal">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <div class="flex items-center gap-3">
                                        <span class="font-mono font-semibold text-[#263c89]">DEC-2024-00457</span>
                                        <span class="badge badge-en-attente">Normal</span>
                                    </div>
                                    <div class="text-muted text-sm mt-1">Créé le 15/01/2024 à 10:15 par Paul FOTSO</div>
                                </div>
                                <div class="text-right">
                                    <div class="text-2xl font-bold text-danger">1 000 000 XAF</div>
                                    <div class="text-sm text-muted">Décaissement Fournisseur</div>
                                </div>
                            </div>

                            <div class="info-grid" style="grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 16px;">
                                <div class="info-item">
                                    <span class="info-label">Bénéficiaire</span>
                                    <span class="info-value">CAMEROON BUILDING MAT.</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Facture</span>
                                    <span class="info-value font-mono">FFOU-2024-00098</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Mode</span>
                                    <span class="info-value">Chèque</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Journal</span>
                                    <span class="info-value">Compte SGBC</span>
                                </div>
                            </div>

                            <!-- Workflow -->
                            <div class="mb-4">
                                <label class="form-label mb-2">Workflow de Validation</label>
                                <div class="workflow-step completed">
                                    <i class="fa-solid fa-check-circle text-success"></i>
                                    <div>
                                        <div class="font-semibold">Demande créée</div>
                                        <div class="text-sm text-muted">Paul FOTSO - 15/01/2024 10:15</div>
                                    </div>
                                </div>
                                <div class="workflow-step current">
                                    <i class="fa-solid fa-clock text-info"></i>
                                    <div>
                                        <div class="font-semibold">En attente de validation</div>
                                        <div class="text-sm text-muted">Jean KAMGA (Trésorier Principal)</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Actions -->
                            <div class="flex justify-between items-center pt-4 border-t">
                                <div class="flex gap-2">
                                    <button class="btn btn-secondary btn-sm" onclick="viewDetails('DEC-2024-00457')">
                                        <i class="fa-solid fa-eye"></i>
                                        Voir Détails
                                    </button>
                                </div>
                                <div class="flex gap-2">
                                    <button class="btn btn-danger btn-sm" onclick="rejectTransaction('DEC-2024-00457')">
                                        <i class="fa-solid fa-times"></i>
                                        Rejeter
                                    </button>
                                    <button class="btn btn-success" onclick="approveTransaction('DEC-2024-00457')">
                                        <i class="fa-solid fa-check"></i>
                                        Approuver
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Reject Modal -->
    <div class="modal-overlay" id="rejectModal">
        <div class="modal modal-sm">
            <div class="modal-header">
                <h3 class="modal-title">Motif de Rejet</h3>
                <button class="modal-close" onclick="closeRejectModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label required">Motif</label>
                    <select id="rejectReason" class="form-select">
                        <option value="">Sélectionner un motif</option>
                        <option value="doc_missing">Documents manquants</option>
                        <option value="amount_error">Erreur de montant</option>
                        <option value="not_authorized">Non autorisé</option>
                        <option value="budget_exceeded">Budget dépassé</option>
                        <option value="other">Autre</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Commentaire</label>
                    <textarea id="rejectComment" class="form-textarea" rows="3" placeholder="Détails supplémentaires..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeRejectModal()">Annuler</button>
                <button class="btn btn-danger" onclick="confirmReject()">
                    <i class="fa-solid fa-times"></i>
                    Confirmer le Rejet
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="./js/sidebar.js"></script>
    <script src="./js/validation-double-signature.js"></script>
</body>
</html>
