<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nouveau Journal - Trésorerie | MultiFlex GESCOM</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">

    <!-- Styles -->
    <link rel="stylesheet" href="./styles/tresorerie-common.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        * { font-family: "Poppins", sans-serif; }
        html, body { margin: 0; padding: 0; height: 100%; }

        /* Stepper Styles */
        .stepper {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            position: relative;
        }
        .stepper::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 10%;
            right: 10%;
            height: 2px;
            background: #E5E7EB;
            z-index: 0;
        }
        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
            cursor: pointer;
            flex: 1;
        }
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #E5E7EB;
            color: #6B7280;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            margin-bottom: 0.5rem;
            transition: all 0.3s;
        }
        .step.active .step-number {
            background: #263c89;
            color: white;
        }
        .step.completed .step-number {
            background: #10B981;
            color: white;
        }
        .step-label {
            font-size: 0.875rem;
            color: #6B7280;
            text-align: center;
        }
        .step.active .step-label {
            color: #263c89;
            font-weight: 600;
        }
        .step.completed .step-label {
            color: #10B981;
        }

        /* Step Content */
        .step-content {
            display: none;
        }
        .step-content.active {
            display: block;
        }

        /* Enhanced Dropdown Select */
        .enhanced-select-container {
            position: relative;
            width: 100%;
        }

        .enhanced-select-trigger {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background: white;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .enhanced-select-trigger:hover {
            border-color: #263c89;
        }

        .enhanced-select-trigger.open {
            border-color: #263c89;
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
        }

        .enhanced-select-trigger.selected {
            border-color: #263c89;
            background: rgba(38, 60, 137, 0.02);
        }

        .enhanced-select-trigger .placeholder {
            color: #9CA3AF;
            flex: 1;
        }

        .enhanced-select-trigger .selected-value {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .enhanced-select-trigger .chevron {
            color: #6B7280;
            transition: transform 0.2s;
        }

        .enhanced-select-trigger.open .chevron {
            transform: rotate(180deg);
        }

        .enhanced-select-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #263c89;
            border-top: none;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            z-index: 100;
            display: none;
            max-height: 320px;
            overflow-y: auto;
        }

        .enhanced-select-dropdown.open {
            display: block;
        }

        .enhanced-select-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            cursor: pointer;
            transition: background 0.15s;
            border-bottom: 1px solid #F3F4F6;
        }

        .enhanced-select-option:last-child {
            border-bottom: none;
        }

        .enhanced-select-option:hover {
            background: #F8FAFC;
        }

        .enhanced-select-option.selected {
            background: rgba(38, 60, 137, 0.08);
        }

        .enhanced-select-option .option-radio {
            width: 18px;
            height: 18px;
            border: 2px solid #D1D5DB;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .enhanced-select-option.selected .option-radio {
            border-color: #263c89;
            background: #263c89;
        }

        .enhanced-select-option.selected .option-radio::after {
            content: '';
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
        }

        .type-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            flex-shrink: 0;
        }
        .type-icon.bank { background: #DBEAFE; color: #2563EB; }
        .type-icon.cash { background: #D1FAE5; color: #059669; }
        .type-icon.mobile { background: #FEF3C7; color: #D97706; }
        .type-icon.petty { background: #E0E7FF; color: #4F46E5; }

        .option-content {
            flex: 1;
        }

        .option-content .option-title {
            font-weight: 500;
            color: #1F2937;
        }

        .option-content .option-code {
            font-size: 12px;
            color: #6B7280;
            font-family: monospace;
        }
    </style>
</head>
<body class="h-full text-gray-800">
    <div class="h-screen flex flex-col">
        <!-- Header -->
        <header class="flex h-16 bg-white shadow-sm z-50">
            <div class="w-60 bg-[#263c89] flex items-center justify-center">
                <img src="https://microfinance-ccm.com/iola/logo-blanc.png" alt="Multiflex" class="h-10">
            </div>
            <div class="flex-1 flex items-center justify-between px-6">
                <h1 class="text-xl font-bold text-[#1A1A1A]">Nouveau Journal de Trésorerie</h1>
                <div class="flex items-center gap-4">
                    <div class="relative">
                        <i class="fa-solid fa-bell text-[#666666] text-lg cursor-pointer"></i>
                    </div>
                    <div class="flex items-center cursor-pointer">
                        <img src="https://storage.googleapis.com/uxpilot-auth.appspot.com/avatars/avatar-2.jpg" class="w-8 h-8 rounded-full mr-3">
                        <span class="text-[14px] text-[#1A1A1A] mr-2">Jean KAMGA</span>
                        <i class="fa-solid fa-chevron-down text-[#666666] text-sm"></i>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="flex-1 flex overflow-hidden">
            <!-- Sidebar -->
            <aside class="w-60 bg-[#263c89] text-white overflow-y-auto">
                <nav class="py-4">
                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mb-2">
                        Module Trésorerie
                    </div>

                    <a href="./dashboard.html" class="sidebar-link" data-page="dashboard">
                        <i class="fa-solid fa-chart-pie mr-3"></i>
                        <span>Dashboard</span>
                    </a>

                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mt-4 mb-2">
                        Journaux
                    </div>

                    <a href="./journals-list.html" class="sidebar-link" data-page="journals-list">
                        <i class="fa-solid fa-book mr-3"></i>
                        <span>Liste Journaux</span>
                    </a>

                    <a href="./journal-create.html" class="sidebar-link active" data-page="journal-create">
                        <i class="fa-solid fa-plus-circle mr-3"></i>
                        <span>Nouveau Journal</span>
                    </a>

                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mt-4 mb-2">
                        Encaissements
                    </div>

                    <a href="./encaissement-create.html" class="sidebar-link" data-page="encaissement-create">
                        <i class="fa-solid fa-arrow-down mr-3"></i>
                        <span>Nouvel Encaissement</span>
                    </a>

                    <a href="./encaissement-imputation.html" class="sidebar-link" data-page="encaissement-imputation">
                        <i class="fa-solid fa-list-check mr-3"></i>
                        <span>Imputation</span>
                    </a>

                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mt-4 mb-2">
                        Décaissements
                    </div>

                    <a href="./decaissement-create.html" class="sidebar-link" data-page="decaissement-create">
                        <i class="fa-solid fa-arrow-up mr-3"></i>
                        <span>Nouveau Décaissement</span>
                    </a>

                    <a href="./validation-double-signature.html" class="sidebar-link" data-page="validation-double-signature">
                        <i class="fa-solid fa-signature mr-3"></i>
                        <span>Double Signature</span>
                        <span class="ml-2 bg-[#F26F21] text-white text-xs px-2 py-0.5 rounded-full">2</span>
                    </a>

                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mt-4 mb-2">
                        Acomptes
                    </div>

                    <a href="./acompte-transport.html" class="sidebar-link" data-page="acompte-transport">
                        <i class="fa-solid fa-truck-ramp-box mr-3"></i>
                        <span>Acompte Transport</span>
                    </a>

                    <div class="px-4 py-2 text-[12px] font-semibold text-white/60 uppercase tracking-wider mt-6 mb-2">
                        Système
                    </div>

                    <a href="../index.html" class="sidebar-link" data-page="home">
                        <i class="fa-solid fa-home mr-3"></i>
                        <span>Accueil</span>
                    </a>
                </nav>
            </aside>

            <!-- Main Content Area -->
            <div class="flex-1 overflow-auto bg-[#F8F9FA]">
                <div class="tresorerie-container" style="max-width: none; padding: 24px;">

                    <!-- Page Header -->
                    <div class="page-header mb-6">
                        <h1 class="page-title">
                            <i class="fa-solid fa-plus-circle"></i>
                            Nouveau Journal de Trésorerie
                        </h1>
                    </div>

                    <!-- Stepper -->
                    <div class="stepper">
                        <div class="step active" data-step="1" onclick="goToStep(1)">
                            <div class="step-number">1</div>
                            <div class="step-label">Informations</div>
                        </div>
                        <div class="step" data-step="2" onclick="goToStep(2)">
                            <div class="step-number">2</div>
                            <div class="step-label">Paramètres</div>
                        </div>
                        <div class="step" data-step="3" onclick="goToStep(3)">
                            <div class="step-number">3</div>
                            <div class="step-label">Sécurité</div>
                        </div>
                        <div class="step" data-step="4" onclick="goToStep(4)">
                            <div class="step-number">4</div>
                            <div class="step-label">Validation</div>
                        </div>
                    </div>

                    <!-- Form Card -->
                    <div class="card">
                        <form id="journalForm">

                            <!-- ========== STEP 1: INFORMATIONS GÉNÉRALES ========== -->
                            <div class="step-content active" id="step1">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fa-solid fa-info-circle"></i>
                                        Onglet 1 : Informations Générales
                                    </h3>
                                    <span class="badge badge-success"><i class="fa-solid fa-check mr-1"></i> Requis</span>
                                </div>
                                <div class="card-body">

                                    <!-- Section Identification -->
                                    <div class="section-title mb-4">
                                        <i class="fa-solid fa-id-card"></i>
                                        Identification
                                    </div>

                                    <!-- Type de Journal - Liste déroulante enrichie -->
                                    <div class="form-group mb-4">
                                        <label class="form-label required">Type de journal</label>
                                        <input type="hidden" id="journalType" name="journalType" value="">

                                        <div class="enhanced-select-container" id="journalTypeSelect">
                                            <!-- Trigger -->
                                            <div class="enhanced-select-trigger" onclick="toggleJournalTypeDropdown()">
                                                <span class="placeholder" id="journalTypePlaceholder">Sélectionner un type de journal...</span>
                                                <div class="selected-value" id="journalTypeSelected" style="display: none;">
                                                    <div class="type-icon" id="selectedTypeIcon"></div>
                                                    <div class="option-content">
                                                        <div class="option-title" id="selectedTypeTitle"></div>
                                                        <div class="option-code" id="selectedTypeCode"></div>
                                                    </div>
                                                </div>
                                                <i class="fa-solid fa-chevron-down chevron"></i>
                                            </div>

                                            <!-- Dropdown Options -->
                                            <div class="enhanced-select-dropdown" id="journalTypeDropdown">
                                                <div class="enhanced-select-option" data-value="BANK_ACCOUNT" onclick="selectJournalType('BANK_ACCOUNT', 'Compte Bancaire', 'bank', 'fa-building-columns')">
                                                    <div class="option-radio"></div>
                                                    <div class="type-icon bank"><i class="fa-solid fa-building-columns"></i></div>
                                                    <div class="option-content">
                                                        <div class="option-title">Compte Bancaire</div>
                                                        <div class="option-code">BANK_ACCOUNT</div>
                                                    </div>
                                                </div>
                                                <div class="enhanced-select-option" data-value="CASH_DESK" onclick="selectJournalType('CASH_DESK', 'Caisse', 'cash', 'fa-cash-register')">
                                                    <div class="option-radio"></div>
                                                    <div class="type-icon cash"><i class="fa-solid fa-cash-register"></i></div>
                                                    <div class="option-content">
                                                        <div class="option-title">Caisse</div>
                                                        <div class="option-code">CASH_DESK</div>
                                                    </div>
                                                </div>
                                                <div class="enhanced-select-option" data-value="MOBILE_MONEY" onclick="selectJournalType('MOBILE_MONEY', 'Mobile Money', 'mobile', 'fa-mobile-screen-button')">
                                                    <div class="option-radio"></div>
                                                    <div class="type-icon mobile"><i class="fa-solid fa-mobile-screen-button"></i></div>
                                                    <div class="option-content">
                                                        <div class="option-title">Mobile Money</div>
                                                        <div class="option-code">MOBILE_MONEY</div>
                                                    </div>
                                                </div>
                                                <div class="enhanced-select-option" data-value="PETTY_CASH" onclick="selectJournalType('PETTY_CASH', 'Petite Caisse', 'petty', 'fa-coins')">
                                                    <div class="option-radio"></div>
                                                    <div class="type-icon petty"><i class="fa-solid fa-coins"></i></div>
                                                    <div class="option-content">
                                                        <div class="option-title">Petite Caisse</div>
                                                        <div class="option-code">PETTY_CASH</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Code & Libellé -->
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label required">Code journal</label>
                                            <input type="text" id="journalCode" class="form-input"
                                                   placeholder="BNK-001" maxlength="20">
                                            <span class="form-help">Code unique (ex: BNK-001, CSH-001, MOB-001)</span>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label required">Libellé</label>
                                            <input type="text" id="journalLabel" class="form-input" required
                                                   placeholder="Compte BICEC Principal">
                                        </div>
                                    </div>

                                    <!-- Société & Devise -->
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label required">Société</label>
                                            <select id="companyId" class="form-select" required>
                                                <option value="">Sélectionner une société</option>
                                                <option value="IOLA_BTP" selected>IOLA BTP SARL</option>
                                                <option value="IOLA_INDUS">IOLA Industries SA</option>
                                                <option value="IOLA_SERVICES">IOLA Services</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Devise</label>
                                            <select id="currency" class="form-select">
                                                <option value="XAF" selected>XAF - Franc CFA</option>
                                                <option value="EUR">EUR - Euro</option>
                                                <option value="USD">USD - Dollar US</option>
                                            </select>
                                        </div>
                                    </div>

                                    <!-- Multi-devises -->
                                    <div class="form-group">
                                        <label class="flex items-center gap-2 cursor-pointer">
                                            <input type="checkbox" id="isMultiCurrency" class="w-4 h-4 accent-[#263c89]">
                                            <span>Activer la gestion multi-devises</span>
                                        </label>
                                    </div>

                                    <!-- ===== Section Détails Bancaires (BANK_ACCOUNT) ===== -->
                                    <div id="bankDetailsSection" class="mt-6" style="display: none;">
                                        <div class="section-title mb-4">
                                            <i class="fa-solid fa-building-columns"></i>
                                            Détails Bancaires
                                        </div>

                                        <div class="form-row">
                                            <div class="form-group">
                                                <label class="form-label required">Banque</label>
                                                <select id="bankName" class="form-select">
                                                    <option value="">Sélectionner une banque</option>
                                                    <option value="BICEC">BICEC</option>
                                                    <option value="SGBC">Société Générale Cameroun</option>
                                                    <option value="AFRILAND">Afriland First Bank</option>
                                                    <option value="UBA">UBA Cameroun</option>
                                                    <option value="ECOBANK">Ecobank Cameroun</option>
                                                    <option value="SCB">SCB Cameroun</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Code banque</label>
                                                <input type="text" id="bankCode" class="form-input" placeholder="10001">
                                            </div>
                                        </div>

                                        <div class="form-row">
                                            <div class="form-group">
                                                <label class="form-label">Code guichet</label>
                                                <input type="text" id="branchCode" class="form-input" placeholder="00050">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label required">N° compte</label>
                                                <input type="text" id="accountNumber" class="form-input" placeholder="12345678901234">
                                            </div>
                                        </div>

                                        <div class="form-row">
                                            <div class="form-group">
                                                <label class="form-label">IBAN</label>
                                                <input type="text" id="iban" class="form-input" placeholder="CM21 1000 1000 5012 3456 7890 1234">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Code SWIFT</label>
                                                <input type="text" id="swiftCode" class="form-input" placeholder="BICECMCX">
                                            </div>
                                        </div>

                                        <div class="form-row">
                                            <div class="form-group">
                                                <label class="form-label">Type compte</label>
                                                <select id="accountType" class="form-select">
                                                    <option value="COURANT">Courant</option>
                                                    <option value="EPARGNE">Épargne</option>
                                                    <option value="BLOQUE">Bloqué</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Titulaire</label>
                                                <input type="text" id="accountHolder" class="form-input" placeholder="IOLA BTP SARL">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- ===== Section Détails Mobile Money ===== -->
                                    <div id="mobileMoneySection" class="mt-6" style="display: none;">
                                        <div class="section-title mb-4">
                                            <i class="fa-solid fa-mobile-screen-button"></i>
                                            Détails Mobile Money
                                        </div>

                                        <div class="form-row">
                                            <div class="form-group">
                                                <label class="form-label required">Opérateur</label>
                                                <select id="mobileOperator" class="form-select">
                                                    <option value="">Sélectionner un opérateur</option>
                                                    <option value="ORANGE_MONEY">Orange Money</option>
                                                    <option value="MTN_MOMO">MTN Mobile Money</option>
                                                    <option value="EXPRESS_UNION">Express Union Mobile</option>
                                                </select>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label required">N° téléphone</label>
                                                <input type="tel" id="mobilePhone" class="form-input" placeholder="+237 699 123 456">
                                            </div>
                                        </div>

                                        <div class="form-row">
                                            <div class="form-group">
                                                <label class="form-label">Code marchand</label>
                                                <input type="text" id="merchantCode" class="form-input" placeholder="OM-IOLA-001">
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Nom compte</label>
                                                <input type="text" id="mobileAccountName" class="form-input" placeholder="IOLA BTP Mobile Money">
                                            </div>
                                        </div>
                                    </div>

                                </div>

                                <div class="card-footer flex justify-end">
                                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                                        Suivant
                                        <i class="fa-solid fa-arrow-right ml-2"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- ========== STEP 2: PARAMÈTRES ========== -->
                            <div class="step-content" id="step2">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fa-solid fa-sliders"></i>
                                        Onglet 2 : Paramètres
                                    </h3>
                                </div>
                                <div class="card-body">

                                    <!-- Section Soldes -->
                                    <div class="section-title mb-4">
                                        <i class="fa-solid fa-coins"></i>
                                        Soldes et Limites
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">Solde d'ouverture</label>
                                            <div class="input-group">
                                                <input type="number" id="openingBalance" class="form-input" value="0" min="0">
                                                <span class="input-group-text">XAF</span>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Date d'ouverture</label>
                                            <input type="date" id="openingDate" class="form-input">
                                        </div>
                                    </div>

                                    <!-- Section Limites (pour caisses) -->
                                    <div id="cashLimitsSection">
                                        <div class="form-row">
                                            <div class="form-group">
                                                <label class="form-label">Plafond retrait/jour</label>
                                                <div class="input-group">
                                                    <input type="number" id="dailyWithdrawLimit" class="form-input" value="10000000">
                                                    <span class="input-group-text">XAF</span>
                                                </div>
                                                <span class="form-help">Pour type CASH_DESK uniquement</span>
                                            </div>
                                            <div class="form-group">
                                                <label class="form-label">Découvert autorisé</label>
                                                <div class="input-group">
                                                    <input type="number" id="overdraftLimit" class="form-input" value="0">
                                                    <span class="input-group-text">XAF</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="alert-box alert-warning mt-3" id="overdraftWarning" style="display: none;">
                                            <i class="fa-solid fa-exclamation-triangle"></i>
                                            <div>Nécessite validation DG</div>
                                        </div>
                                    </div>

                                    <!-- Section Alertes -->
                                    <div class="section-title mb-4 mt-6">
                                        <i class="fa-solid fa-bell"></i>
                                        Seuils d'Alerte
                                    </div>

                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">Seuil d'alerte</label>
                                            <div class="input-group">
                                                <input type="number" id="alertThreshold" class="form-input" value="2000000">
                                                <span class="input-group-text">XAF</span>
                                            </div>
                                            <span class="form-help flex items-center gap-1">
                                                <i class="fa-solid fa-envelope text-blue-500"></i>
                                                Notification si solde &lt; seuil
                                            </span>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Seuil critique</label>
                                            <div class="input-group">
                                                <input type="number" id="criticalThreshold" class="form-input" value="500000">
                                                <span class="input-group-text">XAF</span>
                                            </div>
                                            <span class="form-help flex items-center gap-1">
                                                <i class="fa-solid fa-triangle-exclamation text-red-500"></i>
                                                Alerte urgente + blocage décaissements
                                            </span>
                                        </div>
                                    </div>

                                </div>

                                <div class="card-footer flex justify-between">
                                    <button type="button" class="btn btn-secondary" onclick="prevStep()">
                                        <i class="fa-solid fa-arrow-left mr-2"></i>
                                        Précédent
                                    </button>
                                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                                        Suivant
                                        <i class="fa-solid fa-arrow-right ml-2"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- ========== STEP 3: SÉCURITÉ ========== -->
                            <div class="step-content" id="step3">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fa-solid fa-shield-halved"></i>
                                        Onglet 3 : Paramètres de Sécurité
                                    </h3>
                                    <span class="badge badge-warning"><i class="fa-solid fa-exclamation-triangle mr-1"></i> Important</span>
                                </div>
                                <div class="card-body">

                                    <!-- Double Signature -->
                                    <div class="section-title mb-4">
                                        <i class="fa-solid fa-signature"></i>
                                        Double Signature Électronique
                                    </div>

                                    <div class="form-group mb-4">
                                        <label class="flex items-center gap-2 cursor-pointer">
                                            <input type="checkbox" id="dualSignatureEnabled" class="w-5 h-5 accent-[#263c89]" checked>
                                            <span class="font-medium">Activer la double signature pour ce journal</span>
                                        </label>
                                    </div>

                                    <div id="dualSignatureSettings">
                                        <div class="form-group mb-4">
                                            <label class="form-label">Seuil déclenchement</label>
                                            <div class="input-group" style="max-width: 300px;">
                                                <input type="number" id="dualSignatureThreshold" class="form-input" value="5000000">
                                                <span class="input-group-text">XAF</span>
                                            </div>
                                            <span class="form-help">Montants ≥ seuil nécessitent 2 signatures</span>
                                        </div>

                                        <!-- Signataires autorisés -->
                                        <div class="form-group">
                                            <label class="form-label">Signataires autorisés</label>
                                            <div class="bg-gray-50 rounded-lg p-4 mt-2">
                                                <table class="w-full text-sm">
                                                    <thead>
                                                        <tr class="text-left text-gray-500">
                                                            <th class="pb-2">Nom</th>
                                                            <th class="pb-2">Rôle</th>
                                                            <th class="pb-2">Email</th>
                                                            <th class="pb-2 text-center">Actif</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody id="signatoriesList">
                                                        <tr class="border-t border-gray-200">
                                                            <td class="py-2 font-medium">KAMGA Jean-Paul</td>
                                                            <td class="py-2 text-gray-600">Dir. Financier</td>
                                                            <td class="py-2 text-gray-600">jp.kamga@iola.cm</td>
                                                            <td class="py-2 text-center">
                                                                <input type="checkbox" checked class="w-4 h-4 accent-[#263c89]">
                                                            </td>
                                                        </tr>
                                                        <tr class="border-t border-gray-200">
                                                            <td class="py-2 font-medium">NGONO Sylvie</td>
                                                            <td class="py-2 text-gray-600">Chef Comptable</td>
                                                            <td class="py-2 text-gray-600">s.ngono@iola.cm</td>
                                                            <td class="py-2 text-center">
                                                                <input type="checkbox" checked class="w-4 h-4 accent-[#263c89]">
                                                            </td>
                                                        </tr>
                                                        <tr class="border-t border-gray-200">
                                                            <td class="py-2 font-medium">MBARGA Pierre</td>
                                                            <td class="py-2 text-gray-600">Trésorier</td>
                                                            <td class="py-2 text-gray-600">p.mbarga@iola.cm</td>
                                                            <td class="py-2 text-center">
                                                                <input type="checkbox" checked class="w-4 h-4 accent-[#263c89]">
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                <button type="button" class="btn btn-outline btn-sm mt-3" onclick="addSignatory()">
                                                    <i class="fa-solid fa-plus mr-1"></i>
                                                    Ajouter signataire
                                                </button>
                                            </div>
                                            <div class="alert-box alert-info mt-3">
                                                <i class="fa-solid fa-info-circle"></i>
                                                <div>Minimum 2 signataires requis. Le créateur ne peut pas signer.</div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Statut -->
                                    <div class="section-title mb-4 mt-6">
                                        <i class="fa-solid fa-toggle-on"></i>
                                        Statut et Activation
                                    </div>

                                    <div class="form-group">
                                        <label class="form-label">Statut initial</label>
                                        <div class="flex gap-4 mt-2">
                                            <label class="flex items-center gap-2 cursor-pointer">
                                                <input type="radio" name="initialStatus" value="ACTIVE" checked class="w-4 h-4 accent-[#263c89]">
                                                <span>Actif (ACTIVE)</span>
                                            </label>
                                            <label class="flex items-center gap-2 cursor-pointer">
                                                <input type="radio" name="initialStatus" value="SUSPENDED" class="w-4 h-4 accent-[#263c89]">
                                                <span>Suspendu (SUSPENDED)</span>
                                            </label>
                                        </div>
                                    </div>

                                    <div class="form-group mt-4">
                                        <label class="flex items-center gap-2 cursor-pointer">
                                            <input type="checkbox" id="isDefault" class="w-4 h-4 accent-[#263c89]">
                                            <span>Définir comme journal par défaut pour ce type</span>
                                        </label>
                                    </div>

                                </div>

                                <div class="card-footer flex justify-between">
                                    <button type="button" class="btn btn-secondary" onclick="prevStep()">
                                        <i class="fa-solid fa-arrow-left mr-2"></i>
                                        Précédent
                                    </button>
                                    <button type="button" class="btn btn-primary" onclick="nextStep()">
                                        Suivant
                                        <i class="fa-solid fa-arrow-right ml-2"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- ========== STEP 4: VALIDATION ========== -->
                            <div class="step-content" id="step4">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fa-solid fa-check-double"></i>
                                        Onglet 4 : Validation et Création
                                    </h3>
                                </div>
                                <div class="card-body">

                                    <!-- Récapitulatif -->
                                    <div class="section-title mb-4">
                                        <i class="fa-solid fa-list-check"></i>
                                        Récapitulatif du Journal
                                    </div>

                                    <div class="bg-gray-50 rounded-lg p-6" id="summaryContent">
                                        <!-- Généré dynamiquement par JS -->
                                    </div>

                                    <!-- Alertes de validation -->
                                    <div id="validationAlerts" class="mt-4">
                                        <!-- Alertes générées par JS -->
                                    </div>

                                </div>

                                <div class="card-footer flex justify-between">
                                    <button type="button" class="btn btn-secondary" onclick="prevStep()">
                                        <i class="fa-solid fa-arrow-left mr-2"></i>
                                        Précédent
                                    </button>
                                    <div class="flex gap-3">
                                        <button type="button" class="btn btn-outline" onclick="saveAsDraft()">
                                            <i class="fa-solid fa-save mr-2"></i>
                                            Enregistrer en brouillon
                                        </button>
                                        <button type="button" class="btn btn-success" onclick="createJournal()">
                                            <i class="fa-solid fa-check mr-2"></i>
                                            Créer le Journal
                                        </button>
                                    </div>
                                </div>
                            </div>

                        </form>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="./js/sidebar.js"></script>
    <script src="./js/journal-create.js"></script>
</body>
</html>
