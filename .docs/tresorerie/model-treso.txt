# üè¶ **MOD√àLE DE DONN√âES COMPLET - MODULE TR√âSORERIE ET ENCAISSEMENTS ERP MULTIFLEX**```yaml
# ============================================================================
# MOD√àLE DE DONN√âES COMPLET - MODULE TR√âSORERIE ET ENCAISSEMENTS
# ERP MULTIFLEX - Version 1.0
# ============================================================================

# ----------------------------------------------------------------------------
# SCH√âMA PRINCIPAL : treasury (PostgreSQL)
# Description: Gestion compl√®te de la tr√©sorerie et des flux financiers
# ----------------------------------------------------------------------------

# ============================================================================
# SECTION A : JOURNAUX DE TR√âSORERIE
# ============================================================================

# ----------------------------------------------------------------------------
# TABLE: cash_journals
# Description: Journaux de tr√©sorerie (caisses, banques, mobile money)
# User Stories: US-TRES-001, US-TRES-002
# ----------------------------------------------------------------------------
cash_journals:
  # === IDENTIFIANTS ===
  id: "uuid"                                          # Identifiant unique du journal
  code: "string"                                      # Code unique (ex: BNK-001, CSH-YDE-001)
  name: "string"                                      # Libell√© descriptif
  
  # === TYPE ET CONFIGURATION ===
  journalType: "JournalType"                         # Enum: BANK_ACCOUNT, CASH_DESK, MOBILE_MONEY, PETTY_CASH, VIRTUAL
  owningCompanyId: "string"                          # R√©f√©rence soci√©t√© propri√©taire (MongoDB)
  owningCompanyName: "string"                        # Nom soci√©t√© (d√©normalis√© pour performance)
  
  # === D√âTAILS BANCAIRES (si BANK_ACCOUNT) ===
  bankDetails:
    bankName: "string"                               # Nom de la banque (ex: BICEC, SCB)
    bankCode: "string"                               # Code banque
    branchCode: "string"                             # Code guichet
    accountNumber: "string"                          # Num√©ro de compte
    iban: "string"                                   # IBAN si applicable
    swiftCode: "string"                              # Code SWIFT/BIC
    accountType: "AccountType"                       # CURRENT, SAVINGS, LOAN
    accountHolder: "string"                          # Titulaire du compte
  
  # === D√âTAILS MOBILE MONEY (si MOBILE_MONEY) ===
  mobileMoneyDetails:
    operator: "MobileOperator"                       # ORANGE_MONEY, MTN_MOMO, EXPRESS_UNION
    phoneNumber: "string"                            # Num√©ro de t√©l√©phone
    merchantCode: "string"                           # Code marchand
    accountName: "string"                            # Nom du compte
  
  # === DEVISE ET SOLDES ===
  currency: "string"                                 # Code devise (XAF par d√©faut)
  isMultiCurrency: "boolean"                        # Support multi-devises
  currentBalance: "decimal"                         # Solde comptable actuel
  
  balanceDetails:
    bookBalance: "decimal"                          # Solde comptable (syst√®me)
    bankBalance: "decimal"                          # Solde bancaire (relev√©)
    availableBalance: "decimal"                     # Solde disponible
    lastReconciliationDate: "datetime"              # Derni√®re r√©conciliation
    unreconciledAmount: "decimal"                   # Montant non rapproch√©
  
  # === PARAM√àTRES DE S√âCURIT√â ===
  securitySettings:
    overdraftAuthorized: "decimal"                  # D√©couvert autoris√©
    alertThreshold: "decimal"                       # Seuil d'alerte
    criticalThreshold: "decimal"                    # Seuil critique
    dailyWithdrawLimit: "decimal"                   # Plafond retrait journalier
    dualSignatureThreshold: "decimal"               # Seuil double signature
    dualSignatureRequired: "boolean"                # Double signature activ√©e
    authorizedSigners: ["userId"]                   # Liste signataires autoris√©s
  
  # === STATUT ET M√âTADONN√âES ===
  status: "JournalStatus"                           # ACTIVE, SUSPENDED, CLOSED
  isDefault: "boolean"                              # Journal par d√©faut pour type
  openingBalance: "decimal"                         # Solde d'ouverture
  openingDate: "date"                               # Date d'ouverture
  closingDate: "date"                               # Date de cl√¥ture (si applicable)
  
  # === AUDIT ===
  createdAt: "datetime"
  createdBy: "userId"
  updatedAt: "datetime"
  updatedBy: "userId"
  lastActivityDate: "datetime"                      # Derni√®re transaction

# ----------------------------------------------------------------------------
# TABLE: payment_transactions
# Description: Tous les mouvements de tr√©sorerie
# User Stories: US-TRES-003, US-TRES-008, US-TRES-011
# ----------------------------------------------------------------------------
payment_transactions:
  # === IDENTIFIANTS ===
  id: "uuid"                                        # Identifiant unique transaction
  transactionNumber: "string"                       # N¬∞ unique (ex: TRX-2024-00001)
  documentNumber: "string"                          # N¬∞ document source (ENC-*, DEC-*, VIR-*)
  
  # === TYPE ET CLASSIFICATION ===
  transactionType: "TransactionType"                # RECEIPT, PAYMENT, TRANSFER, ADJUSTMENT, FEE
  transactionSubtype: "TransactionSubtype"          # CLIENT_RECEIPT, SUPPLIER_PAYMENT, etc.
  
  # === JOURNAUX CONCERN√âS ===
  sourceJournalId: "uuid"                          # Journal d√©bit√© (pour transfers/payments)
  sourceJournalCode: "string"                      # Code journal source
  destinationJournalId: "uuid"                     # Journal cr√©dit√©
  destinationJournalCode: "string"                 # Code journal destination
  
  # === PARTENAIRE (si applicable) ===
  partner:
    partnerId: "string"                            # ID MongoDB du partenaire
    partnerCode: "string"                          # Code client/fournisseur
    partnerName: "string"                          # Nom partenaire
    partnerType: "PartnerType"                     # CLIENT, SUPPLIER, EMPLOYEE
  
  # === MONTANTS ET DEVISE ===
  amount: "decimal"                                # Montant principal
  currency: "string"                               # Devise transaction
  exchangeRate: "decimal"                          # Taux de change si diff√©rent devise journal
  amountInJournalCurrency: "decimal"               # Montant converti en devise journal
  
  # === MODE DE PAIEMENT ===
  paymentMethod: "PaymentMethod"                   # CASH, WIRE_TRANSFER, CHECK, MOBILE_MONEY, CREDIT_CARD
  
  paymentMethodDetails:
    # Pour CASH
    cashDetails:
      billsBreakdown: "json"                       # D√©tail coupures {"10000": 5, "5000": 10}
      
    # Pour WIRE_TRANSFER
    wireDetails:
      bankName: "string"
      accountNumber: "string"
      referenceNumber: "string"
      
    # Pour CHECK
    checkDetails:
      checkNumber: "string"
      checkDate: "date"
      bankName: "string"
      drawerName: "string"
      checkStatus: "CheckStatus"                   # DEPOSITED, CLEARED, BOUNCED, CANCELLED
      
    # Pour MOBILE_MONEY
    mobileDetails:
      operator: "MobileOperator"
      phoneNumber: "string"
      transactionRef: "string"
      confirmationCode: "string"
  
  # === DATES ===
  transactionDate: "date"                          # Date de transaction
  valueDate: "date"                                # Date valeur (effective)
  accountingDate: "date"                           # Date comptable
  
  # === IMPUTATIONS (Lettrage) ===
  imputations: [
    {
      documentType: "DocumentType"                 # INVOICE, BILL, ADVANCE
      documentId: "uuid"                          # ID document (facture, avoir, etc.)
      documentNumber: "string"                     # N¬∞ document
      originalAmount: "decimal"                    # Montant original document
      imputedAmount: "decimal"                     # Montant imput√©
      remainingAmount: "decimal"                   # Solde restant
      discount: "decimal"                          # Escompte appliqu√©
      lettrageCode: "string"                       # Code lettrage unique
    }
  ]
  
  # === RAPPROCHEMENT BANCAIRE ===
  reconciliation:
    isReconciled: "boolean"                        # Rapproch√© ou non
    reconciliationDate: "date"                     # Date rapprochement
    bankStatementRef: "string"                     # R√©f√©rence relev√© bancaire
    bankStatementDate: "date"                      # Date relev√©
    reconciledBy: "userId"                         # User qui a rapproch√©
  
  # === VALIDATION ET WORKFLOW ===
  status: "TransactionStatus"                      # DRAFT, PENDING, VALIDATED, CANCELLED, REJECTED
  
  validationWorkflow:
    requiresDualSignature: "boolean"               # N√©cessite double signature
    signatures: [
      {
        signerId: "userId"
        signerName: "string"
        signerRole: "string"
        signatureDate: "datetime"
        signatureStatus: "SignatureStatus"         # PENDING, APPROVED, REJECTED
        comments: "string"
      }
    ]
    currentStep: "string"                          # INITIATION, FIRST_SIGNATURE, SECOND_SIGNATURE, COMPLETED
  
  # === R√âF√âRENCES ET NOTES ===
  reference: "string"                              # R√©f√©rence externe
  description: "string"                            # Description/libell√©
  notes: "text"                                    # Notes internes
  
  # === DOCUMENTS ATTACH√âS ===
  attachments: [
    {
      documentName: "string"
      documentType: "string"                       # PDF, IMAGE, etc.
      documentUrl: "string"
      uploadedAt: "datetime"
      uploadedBy: "userId"
    }
  ]
  
  # === COMPTABILISATION ===
  accounting:
    isPosted: "boolean"                            # Comptabilis√© ou non
    postingDate: "datetime"                        # Date comptabilisation
    journalEntryId: "uuid"                         # ID √©criture comptable
    accountingPeriod: "string"                     # P√©riode comptable
  
  # === AUDIT ===
  createdAt: "datetime"
  createdBy: "userId"
  validatedAt: "datetime"
  validatedBy: "userId"
  cancelledAt: "datetime"
  cancelledBy: "userId"
  cancellationReason: "string"

# ----------------------------------------------------------------------------
# TABLE: customer_receipts
# Description: Bons d'encaissement clients
# User Stories: US-TRES-003, US-TRES-004, US-TRES-007
# ----------------------------------------------------------------------------
customer_receipts:
  # === IDENTIFIANTS ===
  id: "uuid"
  receiptNumber: "string"                          # Format: ENC-YYYY-XXXXX
  
  # === CLIENT ===
  customerId: "string"                             # ID MongoDB client
  customerCode: "string"
  customerName: "string"
  
  # === TRANSACTION ===
  transactionId: "uuid"                            # Lien vers payment_transactions
  journalId: "uuid"                                # Journal de destination
  
  # === MONTANTS ===
  totalAmount: "decimal"                           # Montant total re√ßu
  allocatedAmount: "decimal"                       # Montant affect√© aux factures
  advanceAmount: "decimal"                         # Montant en avance/acompte
  
  # === STATUT ===
  status: "ReceiptStatus"                          # DRAFT, VALIDATED, CANCELLED
  
  # === M√âTADONN√âES ===
  receiptDate: "date"
  createdAt: "datetime"
  createdBy: "userId"

# ----------------------------------------------------------------------------
# TABLE: supplier_payments
# Description: Ordres de d√©caissement fournisseurs
# User Stories: US-TRES-008, US-TRES-009, US-TRES-010
# ----------------------------------------------------------------------------
supplier_payments:
  # === IDENTIFIANTS ===
  id: "uuid"
  paymentNumber: "string"                          # Format: DEC-YYYY-XXXXX
  
  # === FOURNISSEUR ===
  supplierId: "string"                             # ID MongoDB fournisseur
  supplierCode: "string"
  supplierName: "string"
  
  # === TRANSACTION ===
  transactionId: "uuid"                            # Lien vers payment_transactions
  journalId: "uuid"                                # Journal source
  
  # === MONTANTS ===
  totalAmount: "decimal"                           # Montant total √† payer
  invoicesAmount: "decimal"                        # Montant factures
  advanceAmount: "decimal"                         # Avance fournisseur
  withholdingTax: "decimal"                        # Retenue √† la source
  
  # === BATCH (si lot de paiement) ===
  batchId: "uuid"                                  # ID lot de paiement
  batchNumber: "string"                            # N¬∞ lot
  
  # === STATUT ET DATES ===
  status: "PaymentStatus"                          # DRAFT, APPROVED, EXECUTED, CANCELLED
  paymentDate: "date"
  dueDate: "date"
  
  # === M√âTADONN√âES ===
  createdAt: "datetime"
  createdBy: "userId"

# ----------------------------------------------------------------------------
# TABLE: payment_batches
# Description: Lots de paiement fournisseurs
# User Story: US-TRES-010
# ----------------------------------------------------------------------------
payment_batches:
  # === IDENTIFIANTS ===
  id: "uuid"
  batchNumber: "string"                            # Format: LOT-YYYY-XXXXX
  batchName: "string"                              # Nom descriptif
  
  # === CONFIGURATION ===
  journalId: "uuid"                                # Journal source
  paymentMethod: "PaymentMethod"                   # Mode paiement du lot
  executionDate: "date"                            # Date d'ex√©cution pr√©vue
  
  # === PAIEMENTS DU LOT ===
  payments: [
    {
      paymentId: "uuid"                            # ID supplier_payment
      supplierId: "string"
      supplierName: "string"
      amount: "decimal"
      status: "string"
    }
  ]
  
  # === TOTAUX ===
  totalAmount: "decimal"                           # Montant total du lot
  paymentsCount: "integer"                         # Nombre de paiements
  
  # === STATUT ===
  status: "BatchStatus"                            # DRAFT, APPROVED, PROCESSING, COMPLETED, FAILED
  
  # === EXPORT BANCAIRE ===
  bankExport:
    fileName: "string"                             # Nom fichier g√©n√©r√©
    fileFormat: "string"                           # SEPA, AFB320, etc.
    exportDate: "datetime"
    exportedBy: "userId"
    bankResponse: "json"                           # R√©ponse banque si API
  
  # === M√âTADONN√âES ===
  createdAt: "datetime"
  createdBy: "userId"
  approvedAt: "datetime"
  approvedBy: "userId"
  executedAt: "datetime"
  executedBy: "userId"

# ----------------------------------------------------------------------------
# TABLE: bank_reconciliations
# Description: Sessions de rapprochement bancaire
# User Story: US-TRES-012
# ----------------------------------------------------------------------------
bank_reconciliations:
  # === IDENTIFIANTS ===
  id: "uuid"
  reconciliationNumber: "string"                   # Format: RAP-YYYY-XXXXX
  
  # === JOURNAL ET P√âRIODE ===
  journalId: "uuid"                                # Journal bancaire concern√©
  journalCode: "string"
  startDate: "date"                                # D√©but p√©riode
  endDate: "date"                                  # Fin p√©riode
  
  # === SOLDES ===
  bankStatementBalance: "decimal"                  # Solde relev√© bancaire
  systemBalance: "decimal"                         # Solde syst√®me
  difference: "decimal"                            # √âcart
  
  # === LIGNES RAPPROCH√âES ===
  reconciledLines: [
    {
      transactionId: "uuid"                        # Transaction syst√®me
      statementLineRef: "string"                   # Ligne relev√©
      amount: "decimal"
      matchingType: "MatchingType"                 # AUTO, MANUAL, SUGGESTED
      matchingScore: "decimal"                     # Score correspondance (0-100)
    }
  ]
  
  # === LIGNES NON RAPPROCH√âES ===
  unreconciledSystemLines: ["uuid"]                # Transactions syst√®me non rapproch√©es
  unreconciledBankLines: ["json"]                  # Lignes relev√© non rapproch√©es
  
  # === STATUT ===
  status: "ReconciliationStatus"                   # DRAFT, COMPLETED, VALIDATED
  
  # === IMPORT RELEV√â ===
  bankStatement:
    fileName: "string"
    importDate: "datetime"
    importFormat: "string"                         # CSV, OFX, MT940, CAMT053
    statementDate: "date"
    statementNumber: "string"
    linesCount: "integer"
    totalDebit: "decimal"
    totalCredit: "decimal"
  
  # === M√âTADONN√âES ===
  createdAt: "datetime"
  createdBy: "userId"
  validatedAt: "datetime"
  validatedBy: "userId"

# ----------------------------------------------------------------------------
# TABLE: customer_advances
# Description: Avances et acomptes clients
# User Stories: US-TRES-013, US-TRES-014
# ----------------------------------------------------------------------------
customer_advances:
  # === IDENTIFIANTS ===
  id: "uuid"
  advanceNumber: "string"                          # Format: AVA-YYYY-XXXXX
  
  # === CLIENT ===
  customerId: "string"                             # ID MongoDB
  customerCode: "string"
  customerName: "string"
  
  # === TYPE ET ORIGINE ===
  advanceType: "AdvanceType"                       # ADVANCE, DEPOSIT, TRANSPORT_DEPOSIT
  
  sourceDocument:
    documentType: "string"                         # ORDER, TRANSPORT
    documentId: "string"                           # ID BC ou BL
    documentNumber: "string"                       # N¬∞ document
  
  # === MONTANTS ===
  originalAmount: "decimal"                        # Montant initial
  usedAmount: "decimal"                            # Montant utilis√©
  remainingAmount: "decimal"                       # Solde disponible
  
  # === UTILISATION ===
  usage: [
    {
      usageDate: "date"
      documentType: "string"                       # INVOICE, CREDIT_NOTE
      documentId: "uuid"
      documentNumber: "string"
      amount: "decimal"
    }
  ]
  
  # === STATUT ===
  status: "AdvanceStatus"                          # ACTIVE, FULLY_USED, REFUNDED, EXPIRED
  
  # === DATES ===
  receiptDate: "date"                              # Date r√©ception
  expiryDate: "date"                               # Date expiration (optionnel)
  
  # === M√âTADONN√âES ===
  createdAt: "datetime"
  createdBy: "userId"

# ----------------------------------------------------------------------------
# TABLE: aging_buckets
# Description: Balance √¢g√©e clients/fournisseurs
# User Stories: US-TRES-005, US-TRES-009
# ----------------------------------------------------------------------------
aging_buckets:
  # === IDENTIFIANTS ===
  id: "uuid"
  partnerId: "string"                              # ID client/fournisseur
  partnerType: "PartnerType"                       # CLIENT, SUPPLIER
  
  # === P√âRIODES (Buckets) ===
  current: "decimal"                               # Non √©chu
  days_1_30: "decimal"                             # 1-30 jours
  days_31_60: "decimal"                            # 31-60 jours
  days_61_90: "decimal"                            # 61-90 jours
  days_91_120: "decimal"                           # 91-120 jours
  over_120: "decimal"                              # Plus de 120 jours
  
  # === TOTAUX ===
  totalDue: "decimal"                              # Total d√ª
  overdueAmount: "decimal"                         # Montant √©chu
  
  # === D√âTAILS ===
  oldestInvoiceDate: "date"                        # Plus ancienne facture
  averageDaysToPay: "decimal"                      # DSO/DPO moyen
  
  # === M√âTADONN√âES ===
  calculatedAt: "datetime"                         # Date calcul
  nextRecalculation: "datetime"                    # Prochain calcul

# ----------------------------------------------------------------------------
# TABLE: payment_reminders
# Description: Relances clients automatiques
# User Story: US-TRES-006
# ----------------------------------------------------------------------------
payment_reminders:
  # === IDENTIFIANTS ===
  id: "uuid"
  reminderNumber: "string"                         # Format: REL-YYYY-XXXXX
  
  # === CLIENT ===
  customerId: "string"
  customerCode: "string"
  customerName: "string"
  
  # === NIVEAU RELANCE ===
  reminderLevel: "integer"                         # 1, 2, 3...
  reminderType: "ReminderType"                     # PREVENTIVE, LEVEL1, LEVEL2, LEVEL3, LEGAL
  
  # === FACTURES CONCERN√âES ===
  invoices: [
    {
      invoiceId: "uuid"
      invoiceNumber: "string"
      invoiceDate: "date"
      dueDate: "date"
      originalAmount: "decimal"
      outstandingAmount: "decimal"
      daysOverdue: "integer"
    }
  ]
  
  # === MONTANTS ===
  totalOutstanding: "decimal"                      # Total impay√©
  oldestOverdue: "integer"                         # Jours retard max
  
  # === COMMUNICATION ===
  communication:
    channel: "CommunicationChannel"                # EMAIL, SMS, LETTER, WHATSAPP
    recipientEmail: "string"
    recipientPhone: "string"
    templateUsed: "string"                         # Template message
    sentAt: "datetime"
    deliveryStatus: "DeliveryStatus"               # SENT, DELIVERED, FAILED, BOUNCED
  
  # === ACTIONS ET SUIVI ===
  nextAction:
    actionType: "string"                           # NEXT_REMINDER, BLOCK_ACCOUNT, LEGAL_ACTION
    scheduledDate: "date"
  
  customerResponse:
    responseDate: "datetime"
    responseType: "string"                         # PROMISE_TO_PAY, DISPUTE, NO_RESPONSE
    promiseDate: "date"
    notes: "text"
  
  # === STATUT ===
  status: "ReminderStatus"                         # SCHEDULED, SENT, RESPONDED, ESCALATED, CLOSED
  
  # === M√âTADONN√âES ===
  createdAt: "datetime"
  createdBy: "userId"

# ----------------------------------------------------------------------------
# TABLE: cash_flow_forecasts
# Description: Pr√©visions de tr√©sorerie
# User Story: US-TRES-016
# ----------------------------------------------------------------------------
cash_flow_forecasts:
  # === IDENTIFIANTS ===
  id: "uuid"
  forecastDate: "date"                             # Date de la pr√©vision
  
  # === P√âRIODE ===
  periodType: "PeriodType"                         # DAILY, WEEKLY, MONTHLY
  periodStart: "date"
  periodEnd: "date"
  
  # === ENTR√âES PR√âVUES ===
  expectedInflows:
    customerReceipts: "decimal"                    # Encaissements clients
    otherReceipts: "decimal"                       # Autres entr√©es
    totalInflows: "decimal"                        # Total entr√©es
    
    details: [
      {
        source: "string"                           # CLIENT, LOAN, SUBSIDY, OTHER
        partnerId: "string"
        partnerName: "string"
        amount: "decimal"
        probability: "decimal"                     # Probabilit√© r√©alisation (%)
        dueDate: "date"
        notes: "string"
      }
    ]
  
  # === SORTIES PR√âVUES ===
  expectedOutflows:
    supplierPayments: "decimal"                    # Paiements fournisseurs
    salaries: "decimal"                            # Salaires
    taxes: "decimal"                               # Imp√¥ts et taxes
    otherPayments: "decimal"                       # Autres sorties
    totalOutflows: "decimal"                       # Total sorties
    
    details: [
      {
        destination: "string"                      # SUPPLIER, EMPLOYEE, TAX, OTHER
        partnerId: "string"
        partnerName: "string"
        amount: "decimal"
        dueDate: "date"
        isMandatory: "boolean"                     # Paiement obligatoire
        notes: "string"
      }
    ]
  
  # === SOLDES PR√âVISIONNELS ===
  openingBalance: "decimal"                        # Solde d√©but p√©riode
  netCashFlow: "decimal"                           # Flux net (entr√©es - sorties)
  closingBalance: "decimal"                        # Solde fin p√©riode
  minimumBalance: "decimal"                        # Solde minimum pr√©vu
  
  # === ANALYSE ===
  alerts: [
    {
      alertType: "string"                          # NEGATIVE_BALANCE, BELOW_THRESHOLD
      alertDate: "date"
      expectedBalance: "decimal"
      threshold: "decimal"
      severity: "string"                           # LOW, MEDIUM, HIGH, CRITICAL
    }
  ]
  
  # === M√âTADONN√âES ===
  createdAt: "datetime"
  createdBy: "userId"
  lastUpdated: "datetime"

# ----------------------------------------------------------------------------
# TABLE: treasury_kpis
# Description: Indicateurs de performance tr√©sorerie
# User Stories: US-TRES-017, US-TRES-018, US-TRES-019
# ----------------------------------------------------------------------------
treasury_kpis:
  # === IDENTIFIANTS ===
  id: "uuid"
  kpiDate: "date"                                  # Date calcul
  periodType: "string"                             # DAILY, WEEKLY, MONTHLY, YEARLY
  
  # === INDICATEURS LIQUIDIT√â ===
  liquidity:
    totalCash: "decimal"                           # Tr√©sorerie totale
    availableCash: "decimal"                       # Tr√©sorerie disponible
    currentRatio: "decimal"                        # Ratio liquidit√© g√©n√©rale
    quickRatio: "decimal"                          # Ratio liquidit√© imm√©diate
    cashRatio: "decimal"                           # Ratio liquidit√© r√©duite
  
  # === INDICATEURS ACTIVIT√â ===
  activity:
    dso: "decimal"                                 # Days Sales Outstanding
    dpo: "decimal"                                 # Days Payable Outstanding
    cashConversionCycle: "decimal"                 # Cycle conversion cash
    workingCapital: "decimal"                      # BFR
  
  # === INDICATEURS ENCAISSEMENTS ===
  collections:
    totalCollected: "decimal"                      # Total encaiss√© p√©riode
    collectionRate: "decimal"                      # Taux encaissement (%)
    averageCollectionTime: "decimal"               # D√©lai moyen encaissement
    overdueRate: "decimal"                         # Taux impay√©s (%)
    badDebtRate: "decimal"                         # Taux cr√©ances irr√©couvrables
  
  # === INDICATEURS D√âCAISSEMENTS ===
  payments:
    totalPaid: "decimal"                           # Total pay√© p√©riode
    onTimePaymentRate: "decimal"                   # Taux paiement √† temps (%)
    earlyPaymentDiscounts: "decimal"               # Escomptes obtenus
    latePaymentPenalties: "decimal"                # P√©nalit√©s retard
  
  # === M√âTADONN√âES ===
  calculatedAt: "datetime"
  nextCalculation: "datetime"

# ============================================================================
# √âNUM√âRATIONS
# ============================================================================

# Types de journaux
JournalType:
  - BANK_ACCOUNT                                   # Compte bancaire
  - CASH_DESK                                      # Caisse physique
  - MOBILE_MONEY                                   # Orange Money, MTN MoMo
  - PETTY_CASH                                     # Petite caisse
  - VIRTUAL                                        # Compte virtuel/attente

# Types de transactions
TransactionType:
  - RECEIPT                                         # Encaissement
  - PAYMENT                                         # D√©caissement
  - TRANSFER                                        # Virement interne
  - ADJUSTMENT                                      # Ajustement
  - FEE                                            # Frais bancaires

# Sous-types de transactions
TransactionSubtype:
  - CLIENT_RECEIPT                                 # Encaissement client
  - SUPPLIER_PAYMENT                               # Paiement fournisseur
  - SALARY_PAYMENT                                 # Paiement salaire
  - TAX_PAYMENT                                    # Paiement taxes
  - BANK_TO_BANK                                   # Virement entre banques
  - BANK_TO_CASH                                   # Retrait esp√®ces
  - CASH_TO_BANK                                   # Versement esp√®ces
  - MOBILE_TO_BANK                                 # Mobile money vers banque
  - COMMISSION_PAYMENT                             # Paiement commission
  - TRANSPORT_DEPOSIT                              # Acompte transport

# Modes de paiement
PaymentMethod:
  - CASH                                            # Esp√®ces (limite 100K XAF)
  - WIRE_TRANSFER                                  # Virement bancaire
  - CHECK                                          # Ch√®que
  - MOBILE_MONEY                                   # Orange/MTN/Express Union
  - CREDIT_CARD                                    # Carte cr√©dit (rare)
  - PROMISSORY_NOTE                                # Billet √† ordre
  - LETTER_OF_CREDIT                               # Lettre de cr√©dit

# Statuts
TransactionStatus:
  - DRAFT                                           # Brouillon
  - PENDING                                        # En attente validation
  - VALIDATED                                      # Valid√©
  - EXECUTED                                       # Ex√©cut√©
  - CANCELLED                                      # Annul√©
  - REJECTED                                       # Rejet√©

JournalStatus:
  - ACTIVE                                         # Actif
  - SUSPENDED                                     # Suspendu temporairement
  - CLOSED                                        # Cl√¥tur√© d√©finitivement

CheckStatus:
  - DEPOSITED                                      # D√©pos√©
  - CLEARED                                        # Encaiss√©
  - BOUNCED                                        # Rejet√©
  - CANCELLED                                      # Annul√©
  - ON_HOLD                                        # En attente

# ============================================================================
# COLLECTIONS MONGODB ASSOCI√âES
# ============================================================================

# Collection: treasury_settings
treasury_settings:
  companyId: "ObjectId"
  settings:
    defaultCashJournal: "journalId"
    defaultBankJournal: "journalId"
    cashLimit: 100000                              # Limite esp√®ces CEMAC
    reminderLevels: [
      {
        level: 1
        daysAfterDue: 7
        template: "FRIENDLY"
        channels: ["EMAIL"]
      },
      {
        level: 2
        daysAfterDue: 30
        template: "FIRM"
        channels: ["EMAIL", "SMS"]
      },
      {
        level: 3
        daysAfterDue: 60
        template: "FINAL"
        channels: ["EMAIL", "LETTER"]
      }
    ]
    bankFormats:                                    # Formats export bancaire
      - SEPA_XML
      - AFB320
      - MT940
      - CAMT053

# ============================================================================
# √âV√âNEMENTS KAFKA
# ============================================================================
treasury_events:
  - treasury.journal.created
  - treasury.journal.suspended
  - treasury.journal.threshold.alert
  - treasury.receipt.created
  - treasury.receipt.validated
  - treasury.payment.created
  - treasury.payment.approved
  - treasury.payment.executed
  - treasury.transfer.completed
  - treasury.reconciliation.completed
  - treasury.reminder.sent
  - treasury.advance.created
  - treasury.advance.applied
  - treasury.forecast.alert

# ============================================================================
# R√àGLES DE GESTION M√âTIER
# ============================================================================
business_rules:
  - RG-TRES-001: "Limite esp√®ces 100,000 XAF (r√©glementation CEMAC)"
  - RG-TRES-002: "Double signature obligatoire selon seuils d√©finis"
  - RG-TRES-003: "Lettrage FIFO automatique par d√©faut"
  - RG-TRES-004: "Attestation non-redevance obligatoire paiements > 100K"
  - RG-TRES-005: "Rapprochement mensuel obligatoire comptes bancaires"
  - RG-TRES-006: "Relances automatiques selon √©ch√©ancier d√©fini"
  - RG-TRES-007: "Acompte transport 100% avant chargement"
  - RG-TRES-008: "Conservation pi√®ces justificatives 10 ans"
  - RG-TRES-009: "Calcul DSO/DPO quotidien"
  - RG-TRES-010: "Blocage paiement si fournisseur non conforme"
```

---

**Ce mod√®le de donn√©es couvre l'ensemble des 20 user stories du module Tr√©sorerie et Encaissements avec :**

1. **Gestion compl√®te des journaux** (caisses, banques, mobile money)
2. **Tous les flux financiers** (encaissements, d√©caissements, virements)
3. **Lettrage et rapprochement** automatis√©s
4. **Gestion des avances et acomptes** (incluant transport subventionn√©)
5. **Relances automatiques** multi-niveaux
6. **Tableaux de bord et KPIs** temps r√©el
7. **Pr√©visions de tr√©sorerie** avec alertes
8. **Double signature √©lectronique** selon seuils
9. **Support multi-devises** et multi-soci√©t√©s
10. **Conformit√© CEMAC** (limite esp√®ces, attestations fiscales)

Le mod√®le est **pr√™t pour l'impl√©mentation** avec toutes les tables PostgreSQL, collections MongoDB, √©num√©rations et √©v√©nements Kafka n√©cessaires.